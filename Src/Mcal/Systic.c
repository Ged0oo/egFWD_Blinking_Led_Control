/***************************************************************************************************
*   FILE DESCRIPTION
*   ------------------------------------------------------------------------------------------------*/
/**      \file Systick.c
*      \brief
*
*     \details
*
*
****************************************************************************************************/

/****************************************************************************************************
*     INCLUDES
****************************************************************************************************/


#include "Systick.h"
#include "Systick_Cfg.h"
#include "Systick_Types.h"
#include "Mcu_Hw.h"
/***************************************************************************************************
*   LOCAL MACROS CONSTANT\FUNCTION
***************************************************************************************************/

/*************************************************************************************************
*   LOCAL DATA
***********************************************************************************************/

/**********************************************************************************************
*   GLOBAL DATA
*************************************************************************************************/

/***********************************************************************************************
*   LOCAL FUNNCTION PROTOTYPE
************************************************************************************************/

/***********************************************************************************************
*   LOCAL FUNCTIONS 
*************************************************************************************************/

/************************************************************************************************
*   GLOBAL FUNCTIONS
************************************************************************************************/


/***********************************************************************************************
* \Syntax           : Std_ReturnTypefunctionName(AnyType ParameterName)
* \Description      : Describe this service
*
* \Sync\Async       : Synchorouns
* \Reentrancy       : Non Rentrant
* \Parameters (in)  : ParameterName  ParameterDescription
* \Parameters (out) : None
* \Return Value:    :Std_ReturnType  E_OK
                                     E_NOT_OK
**************************************************************************************************/
void Systick_Init(void)
{
	
	#if (CLK_SRC==1)
		RCC&=~(1<<OSCSRC); // Main Osc
	
		RCC|=0x01;        //enable main osc
		RCC|=(FREQ<<XTAL);       
		RCC|=(DIV<<SYSDIV);     
		#if (PLL_EN==1) // Enable
			RCC&=~(1<<BYPASS);
			RCC&=~(1<<PWRDN);
			//while ((READ_BIT(PLLSTAT,0))==0);
		#else //disable
			RCC|=(1<<BYPASS);
			RCC|=(1<<PWRDN);
		#endif
	#else
		RCC|=(1<<4); // internal Osc
		#if (PLL_EN==1) //Enable
			RCC&=~(1<<BYPASS);
			RCC&=~(1<<PWRDN);
			//while ((READ_BIT(PLLSTAT,0))==0);
		#else
			RCC|=(1<<BYPASS);
			RCC|=(1<<PWRDN);
			RCC|= (0<<SYSDIV);
		#endif
	#endif	
}

/************************************************************************************************
*  END OF FILE  :    Systick.C
*************************************************************************************************/